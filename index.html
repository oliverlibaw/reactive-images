<!DOCTYPE html>
<html>
<head>
  <title>Object Detection Web App</title>
</head>
<body>
  <video id="video"></video>
  <img id="image" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tensorflow.js/4.0.0/tensorflow.min.js"></script>
  <script>
    // Load the TensorFlow.js object detection model.
    async function loadModel() {
      return await tf.loadModel("https://tfhub.dev/tensorflow/lite-model/object_detection/coco/ssd_mobilenet_v1/1/default/tflite");
    }
    
    const modelPromise = loadModel();

    // Create a function to get the current frame from the webcam.
    function getFrame() {
      // Get the video element.
      const video = document.getElementById("video");

      // Get the current frame from the video.
      const frame = video.captureStream();

      // Return the frame.
      return frame;
    }

    // Create a function to perform object detection on the current frame.
    async function detectObjects() {
      // Get the current frame from the webcam.
      const frame = getFrame();

      // Load the object detection model.
      const model = await modelPromise;

      // Run the object detection model on the frame.
      const detections = await model.detect(frame);

      // Display the detected objects on the screen.
      for (const detection of detections) {
        const label = detection.classLabel;
        const confidence = detection.confidence;

        // Create a rectangle around the detected object.
        const rect = document.createElement("div");
        rect.style.width = detection.boundingBox.width + "px";
        rect.style.height = detection.boundingBox.height + "px";
        rect.style.left = detection.boundingBox.x + "px";
        rect.style.top = detection.boundingBox.y + "px";
        rect.style.border = "1px solid red";

        // Display the label and confidence of the detected object.
        const labelText = document.createElement("div");
        labelText.textContent = label + " (" + confidence + "%)";

        // Add the rectangle and label to the screen.
        document.body.appendChild(rect);
        document.body.appendChild(labelText);
      }

      // If the object detection model detects eyes, show the image "eyes.jpg".
      if (detections.some(detection => detection.classLabel === "eye")) {
        document.getElementById("image").src = "eyes.jpg";
      } else {
        // If the object detection model does not detect eyes, show the image "no_eyes.jpg".
        document.getElementById("image").src = "no_eyes.jpg";
      }
    }


    // Start the object detection loop.
    setInterval(detectObjects, 1000);

    // Start the webcam stream.
    navigator.mediaDevices.getUserMedia({ video: true }).then(stream => {
      const video = document.getElementById("video");
      video.srcObject = stream;
      video.play();
    });
  </script>
</body>
</html>
