<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eye Detection</title>
    <style>
        /* Add custom CSS styling here */
    </style>
</head>
<body>
    <!-- Display image of person with eyes open or closed -->
    <img id="person" src="" alt="Person image" />

    <!-- Import TensorFlow.js library -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
    <!-- Import your TensorFlow model -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd"> </script>

    <script>
        // Access the user's webcam
        async function getUserMediaStream() {
            try {
                const constraints = {
                    video: true,
                    audio: false
                };
                return await navigator.mediaDevices.getUserMedia(constraints);
            } catch (err) {
                console.error('Error accessing the webcam:', err);
            }
        }

        // Load the TensorFlow model
        async function loadModel() {
            return await tf.loadGraphModel('your_model_path_here.json');
        }

        // Detect eyes in the webcam feed using the TensorFlow model
        async function detectEyes(model, video) {
            // Preprocess the video frame
            const resizedVideo = tf.browser.fromPixels(video).resizeNearestNeighbor([224, 224]).toFloat();
            const inputTensor = resizedVideo.expandDims(0);

            // Run the model
            const output = await model.predict(inputTensor);
            return output;
        }

        // Main function to run the eye detection
        async function runEyeDetection() {
            // Access user's webcam
            const stream = await getUserMediaStream();
            const video = document.createElement('video');
            video.srcObject = stream;
            video.onloadedmetadata = () => {
                video.play();
            };

            // Load the TensorFlow model
            const model = await loadModel();

            // Run the eye detection and update the image
            const personImage = document.getElementById('person');
            setInterval(async () => {
                const eyesDetected = await detectEyes(model, video);

                if (eyesDetected) {
                    personImage.src = 'https://www.istockphoto.com/photo/big-eyes-gm508260102-84927853';
                } else {
                    personImage.src = 'https://www.westend61.de/images/0000695620pw/portrait-of-young-man-with-closed-eyes-DISF002247.jpg';
                }
            }, 1000);
        }

        // Run the eye detection on page load
        window.addEventListener('load', runEyeDetection);
    </script>
</body>
</html>
